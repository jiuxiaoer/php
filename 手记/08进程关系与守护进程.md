## 进程关系与中断信号

### bash进程 与终端
  什么是终端那？ 
  * 通俗的讲就是 输入输出设备 [键盘,显示器]
  * 终端可以 显示数据 产生数据

  什么是 bash 进程
  一般来说我们的 [云主机 虚拟机] 等设备 都是我们虚拟化出来的.我们是没有 [键盘 显示器] 

   Linux 通过 TCP/IP 协议 模拟出 一个实现数据 输入输出的终端 比如 ssh telnet.... 

   sshd服务会打开一个dev/ptmx 这个文件[它是一个伪终端主设备文件]

   bin/bash会打开一个dev/pts[0,1...] [它也是一个伪终端从设备文件]

   ptmx/ptsx 它们通过伪终端设备驱动程序模拟出输入和输出的功能

// bin/bash 启动之后，对终端数据的读取和写入就是通过pts实现的[能实现标准输入，标准输出]
// dev/pts0 0 1 2 标准输入，标准输出，标准错误

// strace 可以通过这个命令查看sshd服务

 总结
 我们通过ssh client连接 sshd服务[它是一个守护进程，它的实现协议是tcp/ip]
 然后sshd 接收客户端连接之后，clone,fork一个进程，同时打开伪终端主设备文件/dev/ptmx
 然后再fork一个进程，同时启动bin/bash [etc/passwd]进程，该进程会打开一个伪终端从设备dev/pts
 这个伪终端能实现数据输入[键盘]，还能实现数据输出[显示器]，这个进程对应的键盘、显示器
 键盘－－－0,显示器---->1,2
 主从设备终端通过伪终端设备驱动程序进行通信的

 ssh client输入的数据，我们可以当作[远程服务器的输入，键盘]
 远程服务器的输出，通过tcp/ip协议传输到ssh client

 bin/bash 接收到数据[是要经过tcp/ip,伪终端设备驱动程序]来完成的
 
### 进程组

 进程组
bash 进程拥有一个终端[输入和输出] 这种终端 我们一般也叫控制终端
进程组 就是一个或者多个 进程的集合 一个进程 有个标识组 ID 表示该进程属于哪个进程组
 bash 进程启动之后 他会自己setsid把自己设置为会话首进程,也会设置自己为组长进程
同时他打开了 伪终端 从设备文件pts [他有一个伪终端驱动程序]
/bin/bash
 ---- php demo22.php  [tcp/ip linux 它有伪终端设备驱动程序 会模拟出一个终端]

 进程 正在执行的程序
 这个进程肯定是在 bin/bash 进程[伪终端]里驱动的
 先创建进程再执行程序
 启动之后 [execve 这个函数给我我们启动的] 他会继承 一些属性 比如说 组id 会话id 同时也会继承 父进程已经打开的文件描述符
 0 1 2 [伪终端的标准输入 标准输出 标准错误 pts,ptmx]
 

### 守护进程

 守护进程
 终端 进程组 会话 有密切联系
 守护进程一半运行在后台 并且没有终端控制 同时守护进程 是一直运行的
 进程启动之后 进程在内存的数据结构 会写入到 proc目录中

 编写守护进程有以下几点要求
1) 设置文件创建屏蔽字 umask(0)  屏蔽 linux 权限
2) 一般父进程先fork 一个子进程 让后父进程退出 子进程 调用 setsid 函数来创建会话
 如果调用 setsid 的进程是组长进程就会报错
当调用 setsid 之后一般会创建 一个子进程 让会话首进程 退出 确保该进程不会再获得控制终端
 unix/linux 发行版本有BSD System v
 进程调用 sid 之后 会变成 组长 进程 会话首进程 不再有控制终端
3)会把 根目录作为工作目录
4) 会把一些文件描述符关闭 标准输入 输出 错误 关掉
fopen(/dev/null)  这是一个空设备文件 可以看做是一个黑洞文件  对改文件任何的读写数据 都会被丢弃
一般喜欢 吧/dev/null 代替 0,1,2
echo “hello" write(1"hello")